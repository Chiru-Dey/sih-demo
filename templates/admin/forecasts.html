{% extends "admin_base.html" %}

{% block title %}Admin - Forecasts & Alerts{% endblock %}

{% block body_class %}admin-dashboard{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin/forecasts.css') }}">
{% endblock %}

{% block content %}
<div class="page-container" role="main" aria-label="Forecasts and Alerts Dashboard">
    <header class="page-header" role="banner">
        <h1 class="visually-hidden">Forecasts and Alerts Dashboard</h1>
    </header>
    
    <!-- Region Filter -->
    <div class="region-filter" role="search" aria-label="Filter forecasts by region">
        <div class="filter-content">
            <div class="search-container">
                <input type="text" id="regionSearch" class="region-search" 
                       placeholder="Search regions..." aria-label="Search regions">
                <button class="search-btn">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            <div class="active-filters" id="activeFilters">
                <!-- Active filter tags will be inserted here -->
            </div>
            <button class="clear-filters" id="clearFilters">
                <i class="fas fa-times"></i> Clear All
            </button>
        </div>
    </div>

    <!-- Main Forecasts Grid -->
    <div class="forecasts-grid">
        <!-- Cyclone Forecasts for Bardhaman -->
        <div class="forecast-card third-party">
            <div class="card-header" role="heading" aria-level="2">
                <h2 id="third-party-header">Trusted Sources</h2>
            </div>
            <div class="forecast-list" id="thirdPartyForecasts">
                <div class="forecast-item">
                    <div class="forecast-content trusted-source">
                        <div class="forecast-header">
                            <span class="region-pill">Bardhaman</span>
                            <span class="timestamp">2h ago</span>
                        </div>
                        <p class="forecast-text">Severe cyclonic storm approaching Bardhaman district. Wind speeds expected to reach 120-140 km/h. Heavy rainfall and flooding likely in low-lying areas. Essential services may be disrupted.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 95%</span>
                            <span class="risk-pill risk-high">High Risk</span>
                            <span class="source">Source: Indian Meteorological Department</span>
                        </div>
                    </div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-content trusted-source">
                        <div class="forecast-header">
                            <span class="region-pill">Hooghly</span>
                            <span class="timestamp">4h ago</span>
                        </div>
                        <p class="forecast-text">Heavy rainfall expected to continue for next 24 hours in Hooghly region. River Damodar levels rising rapidly. Immediate evacuation recommended for Arambagh and surrounding areas.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 88%</span>
                            <span class="risk-pill risk-high">High Risk</span>
                            <span class="source">Source: Central Water Commission</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI-based Forecasts -->
        <div class="forecast-card ai-based">
            <div class="card-header" role="heading" aria-level="2">
                <h2 id="ai-based-header">AI-based Forecasts</h2>
            </div>
            <div class="forecast-list" id="aiForecasts">
                <div class="forecast-item">
                    <div class="forecast-checkbox">
                        <input type="checkbox" id="forecast-ai-1" aria-label="Select landslide risk forecast">
                    </div>
                    <div class="forecast-content">
                        <div class="forecast-header">
                            <span class="region-pill">Darjeeling</span>
                            <span class="timestamp">1h ago</span>
                        </div>
                        <p class="forecast-text">ML model predicts 78% probability of landslides in Darjeeling hills due to sustained rainfall and soil saturation levels. Areas near Kurseong and Kalimpong require immediate attention.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 78%</span>
                            <span class="risk-pill risk-medium">Medium Risk</span>
                            <span class="source">Source: DisasterPredict AI</span>
                        </div>
                    </div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-checkbox">
                        <input type="checkbox" id="forecast-ai-2" aria-label="Select infrastructure warning forecast">
                    </div>
                    <div class="forecast-content">
                        <div class="forecast-header">
                            <span class="region-pill">Kolkata</span>
                            <span class="timestamp">3h ago</span>
                        </div>
                        <p class="forecast-text">Pattern analysis indicates potential structural issues in Howrah Bridge due to increased water levels in Hooghly River. Immediate inspection of support structures recommended.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 85%</span>
                            <span class="risk-pill risk-medium">Medium Risk</span>
                            <span class="source">Source: InfraWatch AI</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="approval-actions" role="group" aria-label="Forecast approval actions">
                <button class="btn-approve" aria-label="Approve selected forecasts">
                    <i class="fas fa-check"></i> Approve Selected
                </button>
                <button class="btn-reject" aria-label="Reject selected forecasts">
                    <i class="fas fa-times" aria-hidden="true"></i> Reject Selected
                </button>
            </div>
        </div>

        <!-- Crowdsourced Forecasts -->
        <div class="forecast-card crowdsourced">
            <div class="card-header" role="heading" aria-level="2">
                <h2 id="crowdsourced-header">Crowdsourced Forecasts</h2>
            </div>
            <div class="forecast-list" id="crowdsourcedForecasts">
                <div class="forecast-item">
                    <div class="forecast-checkbox">
                        <input type="checkbox" id="forecast-cr-1" aria-label="Select local flooding report">
                    </div>
                    <div class="forecast-content">
                        <div class="forecast-header">
                            <span class="region-pill">Kolkata</span>
                            <span class="timestamp">30m ago</span>
                        </div>
                        <p class="forecast-text">Multiple residents reporting rapid water level rise in Burrabazar area. Storm drains near Mahatma Gandhi Road appear blocked. Local businesses affected.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 82%</span>
                            <span class="risk-pill risk-low">Low Risk</span>
                            <span class="source">Source: Community Reports (15 confirmations)</span>
                        </div>
                    </div>
                </div>
                <div class="forecast-item">
                    <div class="forecast-checkbox">
                        <input type="checkbox" id="forecast-cr-2" aria-label="Select heat wave alert">
                    </div>
                    <div class="forecast-content">
                        <div class="forecast-header">
                            <span class="region-pill">Burdwan</span>
                            <span class="timestamp">1h ago</span>
                        </div>
                        <p class="forecast-text">Local health workers report increasing cases of heat-related illnesses in Burdwan city. Temperatures expected to reach 45Â°C. Elderly population at high risk.</p>
                        <div class="forecast-meta">
                            <span class="trust-score-pill">Trust: 79%</span>
                            <span class="risk-pill risk-medium">Medium Risk</span>
                            <span class="source">Source: Health Workers Network (12 confirmations)</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="approval-actions">
                <button class="btn-approve">
                    <i class="fas fa-check"></i> Approve Selected
                </button>
                <button class="btn-reject">
                    <i class="fas fa-times"></i> Reject Selected
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin/forecasts.js') }}"></script>
{% endblock %}